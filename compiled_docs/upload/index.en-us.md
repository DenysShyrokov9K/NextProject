{"meta":"<h2 id=\"Develop Guide\">Develop Guide <a class=\"header-anchor scroll-count-item\" href=\"#Develop Guide\" data-scroll-id=\"Develop Guide\">#</a></h2>\n<h3 id=\"When To Use\">When to Use <a class=\"header-anchor scroll-count-item\" href=\"#When To Use\" data-scroll-id=\"When To Use\">#</a></h3>\n<p>When user want to upload some file to server side or cloud storage, upload component could help user deal with it.</p>\n","api":"<h2 id=\"API\">API <a class=\"header-anchor scroll-count-item\" href=\"#API\" data-scroll-id=\"API\">#</a></h2>\n<h3 id=\"Upload\">Upload <a class=\"header-anchor scroll-count-item\" href=\"#Upload\" data-scroll-id=\"Upload\">#</a></h3>\n<table>\n<thead>\n<tr>\n<th>Param</th>\n<th>Descripiton</th>\n<th>Type</th>\n<th>Default Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>action</td>\n<td>upload url</td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td>shape</td>\n<td>upload button shape<br><br>option:<br>'card'</td>\n<td>Enum</td>\n<td>-</td>\n</tr>\n<tr>\n<td>accept</td>\n<td>file type you want to accept (image/png, image/jpg, .doc, .ppt) See <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/Input#attr-accept\">input accept attribute</a></td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td>data</td>\n<td>extra upload data</td>\n<td>Object/Function</td>\n<td>-</td>\n</tr>\n<tr>\n<td>headers</td>\n<td>upload request headers</td>\n<td>Object</td>\n<td>-</td>\n</tr>\n<tr>\n<td>withCredentials</td>\n<td>Allow request with cookie or not</td>\n<td>Boolean</td>\n<td>true</td>\n</tr>\n<tr>\n<td>beforeUpload</td>\n<td>callback before upload start. returning null/undefined means do nothing, returning object will modify upload options,returning false will stop upload, null/undefined/object/false can be returned directly or wrapped by Promise <br><br><strong>signature</strong>:<br>Function(file: Object, options: Object) =&gt; Bool/Object/Promise<br><strong>params</strong>:<br><em>file</em>: {Object} <br><em>options</em>: {Object} <br><strong>returns</strong>:<br>{Bool/Object/Promise} <br></td>\n<td>Function</td>\n<td>func.noop</td>\n</tr>\n<tr>\n<td>onProgress</td>\n<td>callback when upload progress change <br><br>signaure:<br>Function() =&gt; void</td>\n<td>Function</td>\n<td>func.noop</td>\n</tr>\n<tr>\n<td>onSuccess</td>\n<td>callback when upload success<br><br><strong>signaure</strong>:<br>Function(file: Object, value: Array) =&gt; void<br><strong>params</strong>:<br><em>file</em>: {Object} file<br><em>value</em>: {Array} value</td>\n<td>Function</td>\n<td>func.noop</td>\n</tr>\n<tr>\n<td>onError</td>\n<td>callback when upload failed <br><br><strong>signaure</strong>:<br>Function(file: Object, value: Array) =&gt; void<br><strong>params</strong>:<br><em>file</em>: {Object} file<br><em>value</em>: {Array} fileList</td>\n<td>func.noop</td>\n<td></td>\n</tr>\n<tr>\n<td>children</td>\n<td>children element</td>\n<td>ReactNode</td>\n<td>-</td>\n</tr>\n<tr>\n<td>timeout</td>\n<td>limit request time, unit: ms</td>\n<td>Number</td>\n<td>-</td>\n</tr>\n<tr>\n<td>method</td>\n<td>upload method<br><br>option:<br>'post', 'put'</td>\n<td>Enum</td>\n<td>'post'</td>\n</tr>\n<tr>\n<td>onSelect</td>\n<td>callback when select<br><br>signature:<br>Function() =&gt; void</td>\n<td>Function</td>\n<td>func.noop</td>\n</tr>\n<tr>\n<td>onDrop</td>\n<td>callback when drop file(s)<br><br>signature:<br>Function() =&gt; void</td>\n<td>Function</td>\n<td>func.noop</td>\n</tr>\n<tr>\n<td>value</td>\n<td>file list</td>\n<td>Array</td>\n<td>-</td>\n</tr>\n<tr>\n<td>defaultValue</td>\n<td>default file list</td>\n<td>Array</td>\n<td>-</td>\n</tr>\n<tr>\n<td>listType</td>\n<td>list stye<br><br>option:<br>'text'<br>'image'<br>'card'</td>\n<td>Enum</td>\n<td>-</td>\n</tr>\n<tr>\n<td>formatter</td>\n<td>data format function, for action response is not standard, required params for  response,see <a href=\"#formater\">formatter</a><br><br>signature:<br>Function() =&gt; void</td>\n<td>Function</td>\n<td>-</td>\n</tr>\n<tr>\n<td>limit</td>\n<td>limit max number for upload file</td>\n<td>Number</td>\n<td>Infinity</td>\n</tr>\n<tr>\n<td>dragable</td>\n<td>support dragable or not, attention: this feature only works when <code>ie10+</code>。</td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n<tr>\n<td>disabled</td>\n<td>disable this upload component</td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n<tr>\n<td>onChange</td>\n<td>callback when uploaded file state chagnes<br><br>signature:<br>Function(info: Object) =&gt; void<br>params:<br><em>info</em>: {Object} file info Object</td>\n<td>Function</td>\n<td>func.noop</td>\n</tr>\n<tr>\n<td>onRemove</td>\n<td>callback when file removed，See <a href=\"#onRemove\">onRemove</a><br><br>signature:<br>Function() =&gt; void</td>\n<td>Function</td>\n<td>func.noop</td>\n</tr>\n<tr>\n<td>autoUpload</td>\n<td>auto upload after select file</td>\n<td>Boolean</td>\n<td>true</td>\n</tr>\n<tr>\n<td>afterSelect</td>\n<td>callback after select file, afterSelect only works when autoUpload=false; when autoUpload=true, use beforeUpload to replace it<br><br><strong>signaure</strong>:<br>Function(file: Object) =&gt; Boolean<br><strong>params</strong>:<br><em>file</em>: {Object} null<br><strong>return</strong>:<br>{Boolean} return false will prevent upload file<br>   return false will prevent upload<br></td>\n<td>Function</td>\n<td>func.noop</td>\n</tr>\n<tr>\n<td>request</td>\n<td>custom reuqest method <br><br><strong>signaure</strong>:<br>Function(option: Object) =&gt; Object<br><strong>params</strong>:<br><em>option</em>: {Object} null<br><strong>returns</strong>:<br>{Object} object with abort method<br></td>\n<td>Function</td>\n<td>-</td>\n</tr>\n<tr>\n<td>progressProps</td>\n<td>Progress props</td>\n<td>Object</td>\n<td>-</td>\n</tr>\n<tr>\n<td>isPreview</td>\n<td>is preview state</td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n<tr>\n<td>fileKeyName</td>\n<td>file's key name</td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td>fileNameRender</td>\n<td>custom list's fileName render<br><br><strong>signaure</strong>:<br>Function(file: Object) =&gt; Node<br><strong>params</strong>:<br><em>file</em>: {Object} file<br><strong>return</strong>:<br>{Node} react node<br></td>\n<td>Function</td>\n<td>-</td>\n</tr>\n<tr>\n<td>actionRender</td>\n<td>custom action area render<br><br><strong>signaure</strong>:<br>Function(file: Object) =&gt; Node<br><strong>params</strong>:<br><em>file</em>: {Object} 文件<br><strong>return</strong>:<br>{Node} react node<br></td>\n<td>Function</td>\n<td>-</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"Upload Card\">Upload.Card <a class=\"header-anchor scroll-count-item\" href=\"#Upload Card\" data-scroll-id=\"Upload Card\">#</a></h3>\n<blockquote>\n<p>Inherit from Upload API</p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th>Param</th>\n<th>Descripiton</th>\n<th>Type</th>\n<th>Default Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>onPreview</td>\n<td>callback when click image<br><br><strong>signature</strong>:<br>Function() =&gt; void</td>\n<td>Function</td>\n<td>func.noop</td>\n</tr>\n<tr>\n<td>onChange</td>\n<td>callback when value changes<br><br><strong>signature</strong>:<br>Function() =&gt; void</td>\n<td>Function</td>\n<td>func.noop</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"Upload Drager\">Upload.Drager <a class=\"header-anchor scroll-count-item\" href=\"#Upload Drager\" data-scroll-id=\"Upload Drager\">#</a></h3>\n<blockquote>\n<p>Only Supprt IE10+, Inherit from Upload API</p>\n</blockquote>\n<h3 id=\"Upload Selector\">Upload.Selector <a class=\"header-anchor scroll-count-item\" href=\"#Upload Selector\" data-scroll-id=\"Upload Selector\">#</a></h3>\n<blockquote>\n<p>[Basic Ability] Custom Style for File Selector</p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th>Param</th>\n<th>Descripiton</th>\n<th>Type</th>\n<th>Default Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>disabled</td>\n<td>disable this upload component</td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n<tr>\n<td>multiple</td>\n<td>select more than one file at once, only works on <code>ie10+</code>. Press <code>Ctrl</code> to Select files</td>\n<td>Boolean</td>\n<td>false</td>\n</tr>\n<tr>\n<td>webkitdirectory</td>\n<td>upload a folder or not, only works in chrome</td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n<tr>\n<td>dragable</td>\n<td>support dragable or not, attention: this feature only works when <code>ie10+</code>。</td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n<tr>\n<td>accept</td>\n<td>file type you want to accept (image/png, image/jpg, .doc, .ppt) See <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/Input#attr-accept\">input accept attribute</a></td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td>onSelect</td>\n<td>callback when files are selected<br><br>signature:<br>Function() =&gt; void</td>\n<td>Function</td>\n<td>func.noop</td>\n</tr>\n<tr>\n<td>onDragOver</td>\n<td>callback when files are dragged over<br><br>signature:<br>Function() =&gt; void</td>\n<td>Function</td>\n<td>func.noop</td>\n</tr>\n<tr>\n<td>onDragLeave</td>\n<td>callback when files are dragged leave<br><br>signature:<br>Function() =&gt; void</td>\n<td>Function</td>\n<td>func.noop</td>\n</tr>\n<tr>\n<td>onDrop</td>\n<td>callback when files are dropped<br><br>signature:<br>Function() =&gt; void</td>\n<td>Function</td>\n<td>func.noop</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"Method\">Method <a class=\"header-anchor scroll-count-item\" href=\"#Method\" data-scroll-id=\"Method\">#</a></h2>\n<h3 id=\"Upload Uploader\">Upload.Uploader <a class=\"header-anchor scroll-count-item\" href=\"#Upload Uploader\" data-scroll-id=\"Upload Uploader\">#</a></h3>\n<blockquote>\n<p>[Basic Ability] File Upload Core Ability\nlet uploader = new Upload.Uploader([options]);</p>\n</blockquote>\n<h4>options</h4>\n<table>\n<thead>\n<tr>\n<th>Param</th>\n<th>Descripiton</th>\n<th>Type</th>\n<th>Default Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>action</td>\n<td>upload url</td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td>data</td>\n<td>extra upload data</td>\n<td>Object/Function</td>\n<td>-</td>\n</tr>\n<tr>\n<td>headers</td>\n<td>upload request headers</td>\n<td>Object</td>\n<td>-</td>\n</tr>\n<tr>\n<td>withCredentials</td>\n<td>Allow request with cookie or not</td>\n<td>Boolean</td>\n<td>false</td>\n</tr>\n<tr>\n<td>onProgress</td>\n<td>callback when upload progress change<br><br>signature:<br>Function() =&gt; void</td>\n<td>Function</td>\n<td>noop</td>\n</tr>\n<tr>\n<td>onSuccess</td>\n<td>callback when upload success<br><br>signature:<br>Function() =&gt; void</td>\n<td>Function</td>\n<td>noop</td>\n</tr>\n<tr>\n<td>onError</td>\n<td>callback when upload failed<br><br>signature:<br>Function() =&gt; void</td>\n<td>Function</td>\n<td>noop</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"Custom Request\">Custom Request <a class=\"header-anchor scroll-count-item\" href=\"#Custom Request\" data-scroll-id=\"Custom Request\">#</a></h3>\n<p>某些场景下需要自定义Request,例如对接AWS S3 jd-sdk or aliyun oss sdk. Upload 支持 传入自定义的 request方法.\nUnder some circumstances, a developer may want to overriding default request call method， just like using AWS S3 jd-sdk or aliyun oss sdk. Upload has a prop named request.</p>\n<pre><code>function customRequest(option) {\n    /* coding here */\n    return {abort() {/* coding here */}};\n}\n\n&lt;Upload request={customRequest}/&gt;\n</code></pre>\n<p>a object named 'option' will be pass into customRequest method and it's schema:</p>\n<pre><code>    onProgress: (event: { percent: number }): void\n    onError: (event: Error, body?: Object): void\n    onSuccess: (body: Object): void\n    data: Object // 额外的数据\n    filename: String // 文件名\n    file: File // 原生File对象\n    withCredentials: Boolean // 是否携带cookie\n    action: String // 请求地址\n    method: String // 请求类型 post/put\n    timeout: Number // 超时\n    headers: Object // 请求头\n</code></pre>\n<p>customRequest should return a object with a abort method which can abort a request</p>\n<pre><code>abort(file?: File) =&gt; void: abort the uploading file\n</code></pre>\n<p>customRequest implements reference: https://github.com/alibaba-fusion/next/blob/master/src/upload/runtime/request.jsx</p>\n<h3 id=\"Error Code\">ErrorCode <a class=\"header-anchor scroll-count-item\" href=\"#Error Code\" data-scroll-id=\"Error Code\">#</a></h3>\n<table>\n<thead>\n<tr>\n<th>ErrorCode</th>\n<th>description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>EXCEED_LIMIT</td>\n<td>when limit is set , selected files number + uploaded files number &gt; limit</td>\n</tr>\n<tr>\n<td>BEFOREUPLOAD_REJECT</td>\n<td>BeforeUpload method returns false/Promise.resolve(false)/Promise.reject()</td>\n</tr>\n<tr>\n<td>RESPONSE_FAIL</td>\n<td>Response Error</td>\n</tr>\n</tbody>\n</table>\n<p>All the ErrorCode in <code>Upload.ErrorCode</code>.</p>\n<h3 id=\"On Change Return Data Schema\">onChange Return Data Schema <a class=\"header-anchor scroll-count-item\" href=\"#On Change Return Data Schema\" data-scroll-id=\"On Change Return Data Schema\">#</a></h3>\n<pre><code>    {\n      uid: 'uid',       // file unique ID\n      name: 'xx.png'    // filename\n      state: 'done',    // selected uploading done error\n      response: {\"success\":true}  // server response\n      url: 'https://img.alicdn.com/tps/TB19O79MVXXXXcZXVXXXXXXXXXX-1024-1024.jpg',\n      imgURL: 'https://img.alicdn.com/tps/TB19O79MVXXXXcZXVXXXXXXXXXX-1024-1024.jpg', //optional\n      downloadURL: 'https://img.alicdn.com/tps/TB19O79MVXXXXcZXVXXXXXXXXXX-1024-1024.jpg' // optional\n    }\n</code></pre>\n<h3 id=\"API Response Data Schema\">API Response Data Schema <a class=\"header-anchor scroll-count-item\" href=\"#API Response Data Schema\" data-scroll-id=\"API Response Data Schema\">#</a></h3>\n<pre><code>    {\n      \"success\": true,\n      \"message\": \"upload success\",                           // display when success=false\n      \"url\": \"https://img.alicdn.com/tps/TB19O79MVXXXXcZXVXXXXXXXXXX-1024-1024.jpg\"             // file url\n      \"imgURL\": \"https://img.alicdn.com/tps/TB19O79MVXXXXcZXVXXXXXXXXXX-1024-1024.jpg\",         // file preview url(optional)\n      \"downloadURL\": \"https://img.alicdn.com/tps/TB19O79MVXXXXcZXVXXXXXXXXXX-1024-1024.jpg\",    // file download url(optional)\n    }\n</code></pre>\n<h3 id=\"Server Side Response Format\">Server Side Response Format <a class=\"header-anchor scroll-count-item\" href=\"#Server Side Response Format\" data-scroll-id=\"Server Side Response Format\">#</a></h3>\n<p>Use <code>formatter</code> to transfer nonstandard data to standard data</p>\n<ul>\n<li>\n<p><code>Assume</code>  Server returns such data</p>\n<pre><code>{\n  \"status\": \"success\",\n  \"img_src\": \"https://img.alicdn.com/tps/TB19O79MVXXXXcZXVXXXXXXXXXX-1024-1024.jpg\",\n}\n</code></pre>\n</li>\n<li>\n<p>transfer it</p>\n<pre><code>&lt;Upload\n  action=\"http://127.0.0.1:3001/upload\"\n  formatter={(res) =&gt; {\n    // check the res &amp; return standard data\n    return {\n      success: res.status === 'success',\n      url: res.img_src,\n    }\n  }}\n/&gt;\n</code></pre>\n</li>\n</ul>\n<h2 id=\"Server Side Code Example\">Server side code example <a class=\"header-anchor scroll-count-item\" href=\"#Server Side Code Example\" data-scroll-id=\"Server Side Code Example\">#</a></h2>\n<p>Next Upload components upload files by sending <code>multipart/form-data</code> type request.</p>\n<p>It is no doubt that every kind of server side framework can deal with <code>multipart/form-data</code> type request and extract files from request body. Now we give out 2 examples</p>\n<ul>\n<li><a href=\"https://github.com/alibaba-fusion/next-upload-java-server\">Java Springboot</a></li>\n<li><a href=\"https://github.com/alibaba-fusion/next-upload-node-server\">Node Eggjs</a></li>\n</ul>\n<h2 id=\"IE 9 Compatibility\">IE9 Compatibility <a class=\"header-anchor scroll-count-item\" href=\"#IE 9 Compatibility\" data-scroll-id=\"IE 9 Compatibility\">#</a></h2>\n<ul>\n<li>when enviroment &lt; ie9,  we use iframe as a no-refresh page upload solution, So  You must keep the upload url domain and your page url domain the same.</li>\n<li>when enviroment &lt; ie9, Server side response header, <code>context-type</code> must be <code>text/html</code>, and never be <code>application/json</code></li>\n<li>if only top-level domains the same（<code>taobao.com</code>: top-level domain  <code>shop.taobao.com</code>: second-level domain), you can use methods below to upload file。</li>\n</ul>\n<p>Assume that your form page url domain：shop.taobao.com, while the file server url is upload.taobao.com. Server side should return data with a extra script tag</p>\n<pre><code>    &lt;script&gt;document.domain=\"taobao.com\";&lt;/script&gt;\n    {\"status\":1,\"type\":\"ajax\",\"name\":\"54.png\",\"url\":\".\\/files\\/54.png\"}\n</code></pre>\n<p>iframe upload will request with a param <code>_documentDomain</code>. You can set your domain</p>\n<h2 id=\"ARIA And Key Board\">ARIA and KeyBoard <a class=\"header-anchor scroll-count-item\" href=\"#ARIA And Key Board\" data-scroll-id=\"ARIA And Key Board\">#</a></h2>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">KeyBoard</th>\n<th style=\"text-align:left\">Descripiton</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">Enter</td>\n<td style=\"text-align:left\">1. When the component gets the focus, press <code>Enter</code> to select the file upload  2. Delete uploaded image</td>\n</tr>\n</tbody>\n</table>\n"}